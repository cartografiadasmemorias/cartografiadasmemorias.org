<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta property="og:image" content="https://cartografiadasmemorias.org/media/gota_final.png"  />
  <title>Cartography of Memories</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href="style.css" rel="stylesheet" />
  <!-- Google fonts-->
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans" />
  <link rel="shortcut icon" href="media/favicon.ico" />
 <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">-->
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no"/>
  
    <!-- import the webpage's stylesheet -->
    <link rel="stylesheet" href="style.css">
    
    <!-- import the webpage's javascript file -->
    <script src="script.js"></script>
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://api.mapbox.com/mapbox-gl-js/v1.9.1/mapbox-gl.js"></script>
  <link href="https://api.mapbox.com/mapbox-gl-js/v1.9.1/mapbox-gl.css" rel="stylesheet" />
  <script src="https://npmcdn.com/csv2geojson@latest/csv2geojson.js"></script>
  <script src="https://npmcdn.com/@turf/turf/turf.min.js"></script>
  <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.0.0/mapbox-gl-geocoder.min.js"></script>
  <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.0.0/mapbox-gl-geocoder.css" type="text/css" />
  
</head>

<body>
  
<div id="map"></div>
  
<!-- Sidebar -->
<div class="sidebar bar-block collapse card animate-left" style="width: 100% !important; max-width: 550px !important; display: none;" id="mySidebar">

  <div class="closex" onclick="w3_close()"><b>&times;</b></div> 
   <br><br>
  <hr>
      <div class="row" style="height: 20px;">
        <div class="column" style="text-align:left!important;">
          <a onclick="Sobre()" id="sobre-nav" style="color:#b2c9c9!important;">ABOUT</a>
        </div>
        <div class="column" style="text-align:center!important;">
         <a onclick="Termos()" id="termos-nav" >TERMS	&nbsp;	&nbsp;</a>
        </div>
        <div class="column" style="text-align:right!important;">
          <a onclick="Contato()" id="contato-nav" >CONTACT</a>
        </div>
      </div>
  <hr>
  <br>

      <br><br>
  <div id="sobre" class="sidebarmenu" style="z-index:2;">
       <br><br>
       Cartography of Memories is a collaborative sound map that seeks to record and preserve, through oral reports, experiences in the context of the Covid-19 pandemic. You can collaborate by sending your report or sharing the project on your networks. 
        <br><p></p>
        We want to achieve the greatest number and diversity of reports to configure a heterogeneous panorama, composed of the widest set of views on this worldwide event.
        <br><p></p>
        Non-profit, the project is carried out by people working in different areas: artists, scientists, communicators, developers, disseminators, educators and historians. The group met initially through the <a href="https://labdeemergencia.silo.org.br"  style="color:#23446c;" target="_blank">Emergency Lab | Covid – 19</a> to work collaboratively in building solidarity alternatives in the context of the pandemic.
        <br><p></p>
        This project is supported by an <a href="https://www.opensocietyfoundations.org/"  style="color:#23446c;" target="_blank">Open Society Foundations</a> grant managed by the <a href="https://www.hrdhub.org/arctivism"  style="color:#23446c;" target="_blank">Centre for Applied Human Rights - York University (United Kingdom) [Art + Activism Against Repression During the Covid-19 Crisis]</a>.
        <br><br><p></p>
        <b> TEAM | Collaborators</b><br>
        <br><a href="" style="color:#23446c;" target="_blank">Keila Zaché</a>
        <br><a href="https://www.behance.net/btrzrs" style="color:#23446c;" target="_blank">Beatriz  Arêas</a>
        <br><a href="https://claricelacerda.com" style="color:#23446c;" target="_blank">Clarice G. Lacerda</a>
        <br><a href="https://filosofiaepatrimonio.wordpress.com" style="color:#23446c;" target="_blank">Hércules da Silva Xavier Ferreira</a>
        <br><a href="http://soundcloud.com/jjjulianar" style="color:#23446c;" target="_blank">Juliana R.</a>
        <br><a href="https://touca.ninja" style="color:#23446c;" target="_blank">Sara Lana</a>
        <br><a href="" style="color:#23446c;" target="_blank">Victor Januário</a>
        <br>
        <div class="collapsible"><b>+</b></div>
          <div class="content">
            <b>Have already collaborated with this project: </b>
            <br>Bernardo Baião, Caroline Trindade, Clareana Arôxa, Daniela Lopes, Julia Chacur e Wellison Silva.
          </div>
    <br><br><br>
  </div>

  
  <div id="termos" class="sidebarmenu">
    <br>
      Each audio sent will be pre-listened to. Excerpts with personal identification, if mentioned, will be removed during editing. The location will only be used to compose the sound map of memories.
       <br>
       <p>All audio reports included in the Cartography of Memories sound map are licensed under Creative Commons. The reports can be used for non-commercial purposes, as long as proper credit is attributed.</p>
        <br><br> 
      <div class="center-text">
        <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" style="color: #23446c !important; text-decoration:underline;"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br />This work is licensed under a <br><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
      </div>
  </div>
  
  <div id="contato" class="sidebarmenu">
    <br>
        <p style="text-align:left;"> You can collaborate by sending your report or sharing the project on your networks. In addition to the recording feature available on this platform, reports can also be sent via Whatsapp audio. To do this just click on the icon below: 
</p>
        <a href="https://bit.ly/3eT5VTn" target="_blank" class="fa fa-whatsapp"></a>
        <br><br>
        cartografiadasmemorias@gmail.com 
       <br>
       <br>
        <b>Share and follow</b><br>
       <br>
        <div class="center-text">
           <a href="https://www.twitter.com/carto_memorias" target="_blank" class="fa fa-twitter"></a>&nbsp;&nbsp;&nbsp;
           <a href="https://www.instagram.com/cartografiadasmemorias" target="_blank" class="fa fa-instagram"></a>&nbsp;&nbsp;&nbsp;
           <a href="https://www.facebook.com/cartografiadasmemorias/" target="_blank" class="fa fa-facebook"></a>
        </div>  
  </div>

</div>

  
<div class="sidenav">  
      <div class="menu-fixo">
          <button class="transparent-button my-button teal xlarge hide-large" onclick="w3_open()"><img src= "media/hamburguer_rosa.png" width="100%"></button>   
      </div>  
      <a class="recorder-button" data="Grave seu relato" href="#recorderpopup1"><img src="media/rec_azul.png" width="100%"></a>    
     
    <div class="logo">
          <img src="media/logo_en_v.png" style="max-width:100%; max-height:100%;">
     </div>
  
    <div class="lang center-text" style="font-size:12px;">
      EN<br>
      <a href="index.html" style="font-weight:normal;text-decoration: none;color: #23446c !important;">PT</a>
    </div>
  
</div>

<div class="sidenav-top">  
      <div class="menu-fixo">
          <button class="transparent-button my-button teal xlarge hide-large" onclick="w3_open()"><img src= "media/hamburguer_rosa.png" width="100%"></button>   
      </div>  
     
    <div class="logo_h">
          <img src="media/logo_en_h.png" width="450%">
     </div>
 
</div>  
  
<div class="sidenav-bottom">  
      <a class="recorder-button" data="Grave seu relato" href="#recorderpopup1"><img src="media/rec_azul.png" width="80%"></a>    
    <div class="text-right">
      <b> Record your testimonial</b>  
   </div>
   <div class="lang-mobile">
      EN 	&nbsp;&nbsp;<a href="https://cartografiadasmemorias.org" style="font-weight:normal;text-decoration: none;color: #23446c !important;">PT</a>    
    </div>
 
</div>    
  
      <div class="loadpopup" onclick="myFunction()">
        <span class="loadpopuptext" id="myPopup"><p style="text-align:right; margin:0px;">x</p><img style="width:55px;" src="media/gota_alta.png"><br><br><a style="text-decoration: none; color: #f9f5e4;" href="#recorderpopup1"><b>RECORD HERE</b></a><br>your testimonial<br> it is important<br>for the construction <br>of our memory.</span>
      </div>
  
<div id="recorderpopup1" class="recorderoverlay">
	<div class="recorderpopup">     
    <a class="recorderclose" id="closeButton" href="#" onclick="fechar()">&times;</a>
    <div class="recordercontent" id="recordermsg">
      <p id="mensagem"></p><!--O Js preenche esse campo com a mensagem de retorno da operacao de gravacao-->
      <p id="msgError" hidden>Oops! Something went wrong. Try again!</p>
      <p id="msgConfirm" hidden>We appreciate your contribution. Your testimonial will be added to the Covid-19 pandemic sound map of memories.</p>
      <p id="msgLoading" hidden>Please wait. Your audio is being uploaded.</p>
      <div id="socialMedia" hidden>
          <p>Share and follow</p>
          <a href="https://bit.ly/3cfmBlu"><img src="media/whats_bege.png" /></a>
          <a href="https://twitter.com/Carto_Memorias"><img src="media/twitter_bege.png" /></a>
          <a href="https://www.instagram.com/cartografiadasmemorias/"><img src="media/insta_bege.png" /></a>
          <a href="https://www.facebook.com/cartografiadasmemorias/"><img src="media/fb_bege.png" /></a>
      </div>
    </div>
    <div class="recordercontent" id="recorderinitinstructions">
      <br>
      <p>The audio of your report must be no longer than <u> 5 minutes</u>.</p>
      <p>It is not necessary to identify yourself.</p>
      <p>To add your report to the sound map of memories, allow your device to access your location or enter your country and city.</p>
      <p>By sending the audio you agree to the <a style="color: #b2c9c9 !important; text-decoration:none; " href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">terms</a> and authorizes the non-commercial use of your report.</p>
      <br><br>
      <button class="center-button" onclick="step(1)"><img style="width:110px;" src="media/next.png"></button>
    </div>
		<div class="recordercontent" id="recorderinstructions" hidden>
      <br><p class="center-text" id="msgstart">Click to RECORD</p>
      <p class="center-text" id="msgstop" hidden>Click to STOP</p>
       <div id="controls" class="center-text">
         <button class="transparent-button"  id="recordButton"><img src="media/record.png" class="center center-text" style="width:100%"></button>
         <button class="transparent-button" id="stopButton" hidden><img src="media/stop.png"  class="center center-text" style="width:73%"></button>
      </div>
      <h2  class="center-text" id="counter">00:00</h2>
      <p  class="center-text" id="msgmax">(max. 5 minutes)</p>
    </div>
    <div class="recordercontent" id="recorderlocation" hidden>
     <br>
     <div>
         <p>Location</p>
         <p id ="emptylocationmsg"></p>
         <br>
         <label>City:</label><br>
         <input style="width: 70%; color: #f9f5e4 !important; background-color:transparent!important;border:0px;border-bottom: 1px solid #d9b0af" id="cidade" type="text" required><br>
         <br><br>
         <label>Country:</label><br>
         <input style="width: 70%; color: #f9f5e4 !important;background-color:transparent!important;border:0px;border-bottom: 1px solid #d9b0af" id="bairro" type="text" required><br><br>
         <br><br>
         <button class="center-button" onclick="step(2)"><img style="width:110px;" src="media/next.png"></button>
      </div>
    </div>
    <div class="recordercontent" id="permissaomicrofone" hidden>
      <br><br><br>
      <p id="microfonenegado">Change your microphone's permission. Reload the page and try again.</p>
    </div>
    <ul style="list-style: none;" id="recordingsList"></ul>
    <!-- inserting these scripts at the end to be able to use all the elements in the DOM -->
  	<script src="https://cdn.rawgit.com/mattdiamond/Recorderjs/08e7abd9/dist/recorder.js"></script>
    <script src="en/app.js"></script>
	</div>
  
</div>
  
  

  
  <script>
    var geocoder = new MapboxGeocoder({
       accessToken: mapboxgl.accessToken,
       mapboxgl: mapboxgl
    });
    
    var transformRequest = (url, resourceType) => {
      var isMapboxRequest =
        url.slice(8, 22) === "api.mapbox.com" ||
        url.slice(10, 26) === "tiles.mapbox.com";
      return {
        url: isMapboxRequest
          ? url.replace("?", "?pluginName=sheetMapper&")
          : url
      };
    };
    //YOUR TURN: add your Mapbox token 
    mapboxgl.accessToken = 'pk.eyJ1IjoiY2FydG9ncmFmaWFkYXNtZW1vcmlhcyIsImEiOiJjazlxMDN1aG0wZnY4M2xvZHJjajdldnE3In0.qHPWWLN-r8EmzjGLm3afAA'; //Mapbox token 
    var map = new mapboxgl.Map({
      container: 'map', // container id
      style: 'mapbox://styles/cartografiadasmemorias/ckaoohfqc2lt61iom1u8d9ec3', //stylesheet location
      center: [5.632976, 25.693782], // starting position
      zoom: 0.9,// starting zoom
      transformRequest: transformRequest
    });

    $(document).ready(function () {
      $.ajax({
        type: "GET",
        //YOUR TURN: Replace with csv export link
        url: 'https://docs.google.com/spreadsheets/d/13xv9K7am3ptr-Z9a734OrWoIcyWsZkX3tvUhX4lBOUQ/gviz/tq?tqx=out:csv&sheet=Sheet3',
        dataType: "text",
        success: function (csvData) { makeGeoJSON(csvData); }
      });



      function makeGeoJSON(csvData) {
        csv2geojson.csv2geojson(csvData, {
          latfield: 'Latitude',
          lonfield: 'Longitude',
          delimiter: ','
        }, function (err, data) {
          
          map.on('load', function () {
            
            map.loadImage(
             'media/gota_final.png',
              function(error, image) {
              if (error) throw error;
              map.addImage('ear', image);
            });

            //Add the the layer to the map 
           /* map.addLayer({
              'id': 'csvData',
              'type': 'circle',
              'source': {
                'type': 'geojson',
                'data': data
              },
              'paint': {
                'circle-color': "#981e3a"
              }
              
            }); */

            map.addLayer({
              'id': 'csvData',
              'type': 'symbol',
              'source': {
                'type': 'geojson',
                'data': data
              },
              'layout': {
                'icon-image': 'ear',
                'icon-anchor': 'bottom', // point of the icon which will correspond to marker's location
                "icon-allow-overlap": true,
                //'icon-size': 0.025
              }
             });


            // When a click event occurs on a feature in the csvData layer, open a popup at the
            // location of the feature, with description HTML from its properties.
            map.on('click', 'csvData', function (e) {
              var coordinates = e.features[0].geometry.coordinates.slice();

              //set popup text 
              //You can adjust the values of the popup to match the headers of your CSV. 
              // For example: e.features[0].properties.Name is retrieving information from the field Name in the original CSV. 
              /* player mixcloud
              var description = `<iframe width="100%" height="60" src="` + e.features[0].properties.Audio + `" frameborder="0" allow="autoplay"></iframe>` + `<h4>` + e.features[0].properties.Data + `</h4>` + `<h4>` + `<b>` + ` TAGS` + `</b>` + `<br>` + e.features[0].properties.Tags + `</h4>`;
              */
              
              /*
              player archive.org 
              var description = `<iframe src="` + e.features[0].properties.Audio + `" width="100%" height="30" frameborder="0" webkitallowfullscreen="true" mozallowfullscreen="true" allowfullscreen></iframe>` + `<h4>` + e.features[0].properties.Data + `</h4>` + `<h4>` + `<b>` + `TAGS ` + `</b>` + `<br>` + e.features[0].properties.Tags + `</h4>`;
              */
              
               /*
              player html*/
              var description = `<audio controls style="width:100%;" controlsList="nodownload" autoplay><source src="` + e.features[0].properties.Audio + `" type="audio/mpeg"></audio>` + `<h4>` + e.features[0].properties.Data + `</h4>` + `<h4>` + `<b>` + ` ` + `</b>` + `<br>` + e.features[0].properties.Tags + `</h4>`;
              
              
              
              // Ensure that if the map is zoomed out such that multiple
              // copies of the feature are visible, the popup appears
              // over the copy being pointed to.
              while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
                coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
              }

              //add Popup to map

              new mapboxgl.Popup()
                .setLngLat(coordinates)
                .setHTML(description)
                .addTo(map);
            });

            // Change the cursor to a pointer when the mouse is over the places layer.
            map.on('mouseenter', 'csvData', function () {
              map.getCanvas().style.cursor = 'pointer';
            });
            
             map.on('mouseenter', 'csvData2', function () {
              map.getCanvas().style.cursor = 'pointer';
            });

            // Change it back to a pointer when it leaves.
            map.on('mouseleave', 'places', function () {
              map.getCanvas().style.cursor = '';
            });

            var bbox = turf.bbox(data);
            map.fitBounds(bbox, { padding: 50 });

            map.setLayoutProperty('csvData', 'icon-size', 
            ['interpolate', ['linear'], ['zoom'],
              0,
              //TAMANHO AO ZOOM 0
              0.5,
              6,
              //TAMANHO AO ZOOM 7
              0.7,
              15,
              0.8,
              24,
              //TAMANHO AO ZOOM 24
              1
            ]);
        
            
          });

        });
      };
      
      
    });
    

      map.addControl(new mapboxgl.NavigationControl(), 'top-left');      
    
  </script>

  
<script>
function w3_open() {
  document.getElementById("mySidebar").style.display = "block";
}

function w3_close() {
  document.getElementById("mySidebar").style.display = "none";
}
  
function myFunction() {
  var popup = document.getElementById("myPopup");
  popup.classList.toggle("show");
}
</script>

<script>
$(document).ready(function(){
  $('[data-toggle="tooltip"]').tooltip();
});
</script>

<script>
var coll = document.getElementsByClassName("collapsible");
var i;

for (i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.display === "block") {
      content.style.display = "none";
    } else {
      content.style.display = "block";
    }
  });
}
</script>
  
</body>

</html>